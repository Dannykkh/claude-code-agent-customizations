# Test Scenario Guide

계획 단계에서 기능별 입출력 기대값을 정의하는 가이드.

## 왜 필요한가?

- 구현 전에 "이 입력 → 이 출력"을 정의하면 구현 방향이 명확해짐
- 구현자(teammate)가 테스트 코드를 바로 작성할 수 있음
- 검증(Step 19) 때 이 시나리오대로 실제 테스트 실행 가능
- TDD 접근: 기대 동작 먼저 → 구현 후 → 검증

## 작성 시점

| 시점 | 파일 | 내용 |
|------|------|------|
| **Step 8 (Spec Synthesis)** | claude-spec.md | 전체 기능별 입출력 시나리오 |
| **Step 15 (Section Files)** | section-NN-*.md | 해당 섹션 기능의 상세 테스트 케이스 |

## 시나리오 유형

### 1. 정상 케이스 (Happy Path)

유효한 입력 → 기대하는 정상 출력

```
입력: { name: "홍길동", email: "hong@test.com", role: "user" }
출력: 201 Created, { id: 1, name: "홍길동", email: "hong@test.com" }
```

### 2. 에러 케이스 (Error Cases)

잘못된 입력 → 적절한 에러 응답

```
입력: { name: "" }
출력: 400 Bad Request, { error: "이름은 필수입니다" }

입력: { email: "already@exists.com" }
출력: 409 Conflict, { error: "이미 존재하는 이메일입니다" }

입력: (인증 없이 접근)
출력: 401 Unauthorized
```

### 3. 엣지 케이스 (Edge Cases)

경계값, 특수 상황 → 안전한 처리

```
입력: { name: "a" * 256 }  (최대 길이 초과)
출력: 400, { error: "이름은 255자 이하여야 합니다" }

입력: {}  (빈 객체)
출력: 400, { error: "필수 필드가 누락되었습니다" }

입력: { email: "not-an-email" }  (형식 오류)
출력: 400, { error: "유효한 이메일 형식이 아닙니다" }
```

## 기능 유형별 테스트 패턴

### API (CRUD)

| 동작 | 정상 | 에러 | 엣지 |
|------|------|------|------|
| **Create** | 유효 데이터 → 201 | 필수값 누락 → 400, 중복 → 409 | 빈 body → 400, 최대값 초과 → 400 |
| **Read** | 존재하는 ID → 200 | 없는 ID → 404 | 잘못된 ID 형식 → 400 |
| **Update** | 유효 변경 → 200 | 없는 ID → 404, 권한 없음 → 403 | 빈 body → 400 (변경 없음) |
| **Delete** | 존재하는 ID → 204 | 없는 ID → 404, 권한 없음 → 403 | 이미 삭제됨 → 404 |
| **List** | 데이터 있음 → 200 [...] | - | 데이터 없음 → 200 [], 페이지 초과 → 200 [] |

### 인증/권한

| 케이스 | 입력 | 기대 |
|--------|------|------|
| 로그인 성공 | 올바른 ID/PW | 200, token 반환 |
| 로그인 실패 | 틀린 PW | 401, "비밀번호가 틀립니다" |
| 계정 잠금 | 5회 실패 후 시도 | 423, "계정이 잠겼습니다" |
| 토큰 만료 | 만료된 토큰 | 401, "토큰이 만료되었습니다" |
| 권한 부족 | user가 admin API 접근 | 403, "권한이 없습니다" |

### 화면/UI

| 케이스 | 사용자 행동 | 기대 결과 |
|--------|------------|-----------|
| 폼 제출 성공 | 모든 필드 입력 → 제출 | 성공 메시지, 목록 페이지 이동 |
| 폼 유효성 | 빈 필드로 제출 | 해당 필드 에러 표시 (빨간 테두리 + 메시지) |
| 로딩 상태 | API 호출 중 | 로딩 스피너 표시, 버튼 비활성화 |
| 에러 상태 | API 500 에러 | "문제가 발생했습니다" 에러 메시지 표시 |
| 빈 상태 | 데이터 0건 | "데이터가 없습니다" 안내 메시지 |

### 비즈니스 로직

| 케이스 | 입력 | 기대 |
|--------|------|------|
| 할인 적용 | 쿠폰 코드 "SAVE10" | 10% 할인된 금액 |
| 할인 중복 | 이미 적용된 상태에서 재적용 | "이미 적용된 쿠폰입니다" |
| 재고 부족 | 주문 수량 > 재고 | "재고가 부족합니다" |

## 테이블 형식 (섹션 파일용)

각 섹션의 Test Scenarios는 이 형식으로 작성:

```markdown
## Test Scenarios

### POST /api/users (사용자 생성)

| 케이스 | 입력 | 기대 결과 |
|--------|------|-----------|
| 정상 생성 | { name: "홍길동", email: "hong@test.com" } | 201, { id: 1, name: "홍길동" } |
| 필수값 누락 | { email: "hong@test.com" } | 400, "이름은 필수입니다" |
| 이메일 중복 | { name: "김철수", email: "existing@test.com" } | 409, "이미 존재하는 이메일" |
| 이메일 형식 오류 | { name: "홍길동", email: "invalid" } | 400, "유효한 이메일 형식이 아닙니다" |
| 이름 최대값 초과 | { name: "a"*256 } | 400, "이름은 255자 이하" |

### GET /api/users/:id (사용자 조회)

| 케이스 | 입력 | 기대 결과 |
|--------|------|-----------|
| 정상 조회 | GET /api/users/1 | 200, { id: 1, name: "홍길동", ... } |
| 없는 사용자 | GET /api/users/9999 | 404, "사용자를 찾을 수 없습니다" |
| 잘못된 ID | GET /api/users/abc | 400, "유효하지 않은 ID" |
```

## 검증 연동 (Step 19 Phase 2)

런타임 검증 시 이 시나리오를 활용:
1. 테스트 코드가 이 시나리오를 커버하는지 정적 확인 (Phase 1)
2. 실제 테스트 실행 결과와 기대값 대조 (Phase 2)
